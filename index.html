<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valeurs en Priorit√© ABC - LS4YOU</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --turquoise: #5DD9C1;
            --jaune: #FFD23F;
            --rose: #FF8FA3;
            --orange: #FFB84D;
            --rouge: #E84855;
            --bleu: #4A90E2;
            --gris-clair: #F8F9FA;
            --gris-fonce: #2C3E50;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: var(--gris-fonce);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .background-decoration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
            opacity: 0.03;
            background-image: 
                repeating-linear-gradient(45deg, var(--turquoise) 0px, transparent 2px, transparent 10px),
                repeating-linear-gradient(-45deg, var(--rose) 0px, transparent 2px, transparent 10px);
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease-out;
        }

        .logo-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .logos-container {
            display: flex;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .project-logo {
            height: 60px;
            width: auto;
            object-fit: contain;
            transition: transform 0.3s ease;
        }

        .project-logo:hover {
            transform: scale(1.05);
        }

        .ml-logo {
            height: 55px;
            width: auto;
            object-fit: contain;
        }

        .puzzle-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--turquoise) 0%, var(--rouge) 50%, var(--jaune) 100%);
            border-radius: 20px;
            position: relative;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            animation: pulse 2s ease-in-out infinite;
        }

        .puzzle-icon::before,
        .puzzle-icon::after {
            content: '';
            position: absolute;
            background: rgba(255,255,255,0.3);
            border-radius: 8px;
        }

        .puzzle-icon::before {
            width: 30px;
            height: 30px;
            top: 10px;
            left: 10px;
        }

        .puzzle-icon::after {
            width: 25px;
            height: 25px;
            bottom: 12px;
            right: 12px;
        }

        h1 {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--turquoise), var(--rouge), var(--jaune));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
            letter-spacing: -1px;
        }

        .subtitle {
            font-size: 1.3rem;
            color: #666;
            font-weight: 400;
        }

        .exercice-tag {
            display: inline-block;
            background: var(--turquoise);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 15px rgba(93, 217, 193, 0.3);
        }

        .step-container {
            background: white;
            border-radius: 25px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease-out;
            animation-fill-mode: both;
        }

        .step-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background: linear-gradient(180deg, var(--turquoise), var(--jaune), var(--rose));
        }

        .step-container.hidden {
            display: none;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .step-number {
            width: 50px;
            height: 50px;
            background: var(--turquoise);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: 700;
            flex-shrink: 0;
            box-shadow: 0 4px 15px rgba(93, 217, 193, 0.3);
        }

        .step-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--gris-fonce);
        }

        .step-description {
            background: var(--gris-clair);
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            border-left: 4px solid var(--jaune);
        }

        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .value-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: 1.5rem;
            border-radius: 15px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .value-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--turquoise), var(--jaune));
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }

        .value-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .value-card.selected {
            border-color: var(--turquoise);
            box-shadow: 0 8px 25px rgba(93, 217, 193, 0.3);
        }

        .value-card.selected::before {
            opacity: 0.05;
        }

        .value-content {
            position: relative;
            z-index: 1;
        }

        .value-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .value-name {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 0.3rem;
            color: var(--gris-fonce);
        }

        .value-description {
            font-size: 0.85rem;
            color: #666;
            line-height: 1.4;
        }

        .checkbox-custom {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 28px;
            height: 28px;
            border: 3px solid #ddd;
            border-radius: 8px;
            background: white;
            transition: all 0.3s ease;
        }

        .value-card.selected .checkbox-custom {
            background: var(--turquoise);
            border-color: var(--turquoise);
        }

        .checkbox-custom::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            color: white;
            font-weight: 700;
            font-size: 1.2rem;
            transition: transform 0.2s ease;
        }

        .value-card.selected .checkbox-custom::after {
            transform: translate(-50%, -50%) scale(1);
        }

        .selected-values-summary {
            background: linear-gradient(135deg, var(--turquoise), var(--bleu));
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 6px 20px rgba(93, 217, 193, 0.3);
        }

        .selected-values-summary h3 {
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .selected-values-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .selected-value-tag {
            background: rgba(255,255,255,0.25);
            padding: 0.5rem 1rem;
            border-radius: 50px;
            font-weight: 500;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        .categories-section {
            background: var(--gris-clair);
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .category-card {
            background: white;
            padding: 1.2rem;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
        }

        .category-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            border-color: var(--turquoise);
        }

        .category-card.selected {
            border-color: var(--turquoise);
            background: linear-gradient(135deg, rgba(93, 217, 193, 0.05), rgba(93, 217, 193, 0.1));
        }

        .category-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .category-name {
            font-weight: 600;
            color: var(--gris-fonce);
            font-size: 1rem;
            margin-bottom: 0.3rem;
        }

        .category-examples {
            font-size: 0.8rem;
            color: #666;
            font-style: italic;
        }

        .objectives-smart-input {
            margin-bottom: 1.5rem;
        }

        .smart-objective-card {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 1.5rem;
            border: 3px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .smart-objective-card:hover {
            box-shadow: 0 6px 20px rgba(0,0,0,0.08);
        }

        .smart-objective-card.has-category {
            border-left: 6px solid var(--turquoise);
        }

        .objective-card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }

        .objective-number-badge {
            background: linear-gradient(135deg, var(--turquoise), var(--bleu));
            color: white;
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3rem;
            box-shadow: 0 4px 12px rgba(93, 217, 193, 0.3);
        }

        .category-badge {
            background: rgba(93, 217, 193, 0.1);
            color: var(--turquoise);
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            border: 2px solid var(--turquoise);
        }

        .smart-section {
            margin-bottom: 1.2rem;
        }

        .smart-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 600;
            color: var(--gris-fonce);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .smart-letter {
            background: linear-gradient(135deg, var(--jaune), var(--orange));
            color: var(--gris-fonce);
            width: 28px;
            height: 28px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 2px 6px rgba(255, 210, 63, 0.3);
        }

        .smart-help {
            font-size: 0.8rem;
            color: #666;
            font-style: italic;
            margin-bottom: 0.5rem;
        }

        .category-select-btn {
            background: white;
            border: 2px dashed var(--turquoise);
            color: var(--turquoise);
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            width: 100%;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .category-select-btn:hover {
            background: var(--turquoise);
            color: white;
        }

        .category-select-btn.selected {
            background: var(--turquoise);
            color: white;
            border-style: solid;
        }

        .objectives-priority-container {
            margin-bottom: 1.5rem;
        }

        .priority-objective-card {
            background: white;
            padding: 1.8rem;
            border-radius: 15px;
            margin-bottom: 1.2rem;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .priority-objective-card:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .priority-objective-summary {
            background: var(--gris-clair);
            padding: 1.2rem;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .priority-objective-title {
            font-weight: 700;
            color: var(--gris-fonce);
            font-size: 1.15rem;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .priority-objective-details {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.5;
        }

        .smart-recap {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.6rem;
            margin-top: 0.8rem;
        }

        .smart-recap-item {
            background: white;
            padding: 0.5rem;
            border-radius: 6px;
            font-size: 0.8rem;
            border-left: 3px solid var(--jaune);
        }

        .smart-recap-label {
            font-weight: 600;
            color: var(--gris-fonce);
            display: block;
            margin-bottom: 0.2rem;
        }

        .objectives-input {
            margin-bottom: 1.5rem;
        }

        .objective-item {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1rem;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
        }

        .objective-item:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .objective-header {
            display: flex;
            gap: 1rem;
            align-items: start;
            margin-bottom: 1rem;
        }

        .objective-label {
            font-weight: 600;
            color: var(--gris-fonce);
            margin-bottom: 0.5rem;
        }

        input[type="text"],
        textarea {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: var(--turquoise);
            box-shadow: 0 0 0 3px rgba(93, 217, 193, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .priority-selector {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.8rem;
        }

        .priority-btn {
            flex: 1;
            padding: 0.8rem;
            border: 2px solid #e9ecef;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .priority-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .priority-btn.selected {
            border-width: 3px;
        }

        .priority-btn.priority-a {
            border-color: var(--rouge);
            color: var(--rouge);
        }

        .priority-btn.priority-a.selected {
            background: var(--rouge);
            color: white;
        }

        .priority-btn.priority-b {
            border-color: var(--orange);
            color: var(--orange);
        }

        .priority-btn.priority-b.selected {
            background: var(--orange);
            color: white;
        }

        .priority-btn.priority-c {
            border-color: var(--jaune);
            color: #d4a017;
        }

        .priority-btn.priority-c.selected {
            background: var(--jaune);
            color: var(--gris-fonce);
        }

        .priority-legend {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            font-size: 0.9rem;
        }

        .priority-legend-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.5rem;
        }

        .priority-legend-item:last-child {
            margin-bottom: 0;
        }

        .priority-badge {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: white;
            flex-shrink: 0;
        }

        .priority-badge.a { background: var(--rouge); }
        .priority-badge.b { background: var(--orange); }
        .priority-badge.c { background: var(--jaune); color: var(--gris-fonce); }

        .action-input {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px dashed #e9ecef;
        }

        .btn-container {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }

        .btn {
            flex: 1;
            padding: 1rem 2rem;
            border: none;
            border-radius: 15px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--turquoise), var(--bleu));
            color: white;
        }

        .btn-secondary {
            background: white;
            color: var(--gris-fonce);
            border: 2px solid #e9ecef;
        }

        .btn-download {
            background: linear-gradient(135deg, var(--rose), var(--rouge));
            color: white;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .validation-message {
            background: #fff3cd;
            color: #856404;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--orange);
        }

        .synthesis-preview {
            background: linear-gradient(135deg, #ffffff 0%, var(--gris-clair) 100%);
            padding: 2rem;
            border-radius: 20px;
            margin-top: 2rem;
            border: 3px solid var(--turquoise);
        }

        .synthesis-section {
            margin-bottom: 2rem;
        }

        .synthesis-section:last-child {
            margin-bottom: 0;
        }

        .synthesis-section h3 {
            color: var(--turquoise);
            margin-bottom: 1rem;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .value-explanation {
            background: white;
            padding: 1.2rem;
            border-radius: 12px;
            margin-bottom: 0.8rem;
            border-left: 4px solid var(--turquoise);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .value-explanation h4 {
            color: var(--gris-fonce);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .value-explanation p {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .objective-card {
            background: white;
            padding: 1.2rem;
            border-radius: 12px;
            margin-bottom: 0.8rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .objective-card-header {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            margin-bottom: 0.8rem;
        }

        .objective-priority-badge {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
            flex-shrink: 0;
        }

        .objective-title {
            font-weight: 600;
            color: var(--gris-fonce);
            flex: 1;
        }

        .objective-details {
            font-size: 0.9rem;
            color: #666;
            line-height: 1.5;
        }

        .action-highlight {
            background: var(--gris-clair);
            padding: 1rem;
            border-radius: 10px;
            margin-top: 0.8rem;
            border-left: 4px solid var(--jaune);
        }

        .action-highlight strong {
            color: var(--rouge);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .step-container:nth-child(1) { animation-delay: 0s; }
        .step-container:nth-child(2) { animation-delay: 0.1s; }
        .step-container:nth-child(3) { animation-delay: 0.2s; }
        .step-container:nth-child(4) { animation-delay: 0.3s; }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .subtitle {
                font-size: 1rem;
            }

            .values-grid {
                grid-template-columns: 1fr;
            }

            .btn-container {
                flex-direction: column;
            }

            .step-container {
                padding: 1.5rem;
            }

            .puzzle-icon {
                width: 60px;
                height: 60px;
            }
        }

        .info-callout {
            background: linear-gradient(135deg, var(--bleu), var(--turquoise));
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 6px 20px rgba(74, 144, 226, 0.3);
        }

        .info-callout h3 {
            margin-bottom: 0.8rem;
            font-size: 1.2rem;
        }

        .info-callout p {
            opacity: 0.95;
            line-height: 1.6;
        }

        .footer {
            text-align: center;
            padding: 2rem;
            color: #666;
            font-size: 0.9rem;
        }

        .ml-branding {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
            font-weight: 600;
        }

        /* Modal de s√©lection de cat√©gorie */
        .category-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .category-modal.active {
            display: flex;
        }

        .category-modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .category-modal-header {
            margin-bottom: 1.5rem;
        }

        .category-modal-header h3 {
            color: var(--gris-fonce);
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .category-modal-header p {
            color: #666;
            font-size: 0.9rem;
        }

        .category-modal-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .category-modal-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: 1rem;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .category-modal-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--turquoise);
        }

        .category-modal-card.selected {
            border-color: var(--turquoise);
            background: linear-gradient(135deg, rgba(93, 217, 193, 0.1), rgba(93, 217, 193, 0.15));
            box-shadow: 0 4px 15px rgba(93, 217, 193, 0.3);
        }

        .category-modal-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .category-modal-name {
            font-weight: 600;
            color: var(--gris-fonce);
            font-size: 0.9rem;
        }

        .category-modal-buttons {
            display: flex;
            gap: 1rem;
        }

        .category-modal-buttons .btn {
            flex: 1;
        }
    </style>
</head>
<body>
    <div class="background-decoration"></div>

    <!-- Modal de s√©lection de cat√©gorie -->
    <div class="category-modal" id="categoryModal">
        <div class="category-modal-content">
            <div class="category-modal-header">
                <h3>Choisir une cat√©gorie</h3>
                <p>S√©lectionnez la cat√©gorie qui correspond le mieux √† votre objectif</p>
            </div>
            <div class="category-modal-grid" id="categoryModalGrid"></div>
            <div class="category-modal-buttons">
                <button class="btn btn-secondary" onclick="closeCategoryModal()">Annuler</button>
                <button class="btn btn-primary" onclick="confirmCategorySelection()">Valider</button>
            </div>
        </div>
    </div>
    
    <div class="container">
        <header>
            <div class="exercice-tag">EXERCICE LS4YOU</div>
            
            <div class="logos-container">
                <img src="https://www.lifeskills4youth.eu/wp-content/uploads/2024/07/LS4YOU_Logo_whiteback.jpg" 
                     alt="LS4YOU Logo" 
                     class="project-logo">
                <img src="https://static.wixstatic.com/media/dd5dab_47743b1c86024865ba19e623a3db327f~mv2.avif/v1/fill/w_224,h_60,al_c,q_80,enc_avif,quality_auto/dd5dab_47743b1c86024865ba19e623a3db327f~mv2.avif" 
                     alt="Mission Locale Pays Basque" 
                     class="ml-logo">
            </div>

            <div class="logo-section">
                <div class="puzzle-icon"></div>
                <div>
                    <h1>Valeurs en Priorit√© ABC</h1>
                    <p class="subtitle">Fa√ßonner votre identit√© personnelle</p>
                </div>
            </div>
        </header>

        <!-- √âTAPE 1: IDENTIFIER -->
        <div class="step-container" id="step1">
            <div class="step-header">
                <div class="step-number">1</div>
                <div class="step-title">Identifier mes valeurs</div>
            </div>

            <div class="step-description">
                <strong>üìç Consigne :</strong> Cochez 5 √† 7 valeurs qui sont vraiment prioritaires pour vous. Ces valeurs guident vos choix et refl√®tent qui vous √™tes.
            </div>

            <div class="info-callout">
                <h3>üí° Qu'est-ce qu'une valeur ?</h3>
                <p>Une valeur, c'est ce qui compte vraiment pour vous, ce qui guide vos d√©cisions au quotidien. Par exemple, si la <strong>pers√©v√©rance</strong> est importante pour vous, vous allez terminer ce que vous commencez malgr√© les obstacles.</p>
            </div>

            <div id="valuesGrid" class="values-grid"></div>

            <div id="selectionSummary" class="selected-values-summary" style="display: none;">
                <h3>‚ú® Mes valeurs s√©lectionn√©es (<span id="selectedCount">0</span>/7)</h3>
                <div id="selectedValuesList" class="selected-values-list"></div>
            </div>

            <div id="validationMsg" class="validation-message" style="display: none;"></div>

            <div class="btn-container">
                <button class="btn btn-primary" onclick="goToStep2a()" id="btnStep1">
                    Continuer ‚Üí D√©finir mes objectifs
                </button>
            </div>
        </div>

        <!-- √âTAPE 2A: D√âFINIR MES OBJECTIFS (SMART) -->
        <div class="step-container hidden" id="step2a">
            <div class="step-header">
                <div class="step-number">2A</div>
                <div class="step-title">D√©finir mes objectifs (m√©thode SMART)</div>
            </div>

            <div class="step-description">
                <strong>üéØ Consigne :</strong> D√©finissez 3 objectifs importants pour vous. Utilisez les cat√©gories ci-dessous pour vous inspirer, puis pr√©cisez-les avec la m√©thode SMART.
            </div>

            <div class="info-callout">
                <h3>üí° Qu'est-ce qu'un objectif SMART ?</h3>
                <p><strong>S</strong>p√©cifique - <strong>M</strong>esurable - <strong>A</strong>tteignable - <strong>R</strong>√©aliste - <strong>T</strong>emporel : un objectif bien d√©fini qui pr√©cise QUOI faire, COMMENT le mesurer, et QUAND le faire.</p>
            </div>

            <div class="categories-section" id="categoriesSection">
                <h3 style="color: var(--gris-fonce); margin-bottom: 1rem; font-size: 1.2rem;">üìÇ Cat√©gories d'objectifs (pour vous inspirer)</h3>
                <div class="categories-grid" id="categoriesGrid"></div>
            </div>

            <div class="objectives-smart-input" id="objectivesSmartContainer"></div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goToStep1()">
                    ‚Üê Retour aux valeurs
                </button>
                <button class="btn btn-primary" onclick="goToStep2b()" id="btnStep2a">
                    Continuer ‚Üí Prioriser mes objectifs
                </button>
            </div>
        </div>

        <!-- √âTAPE 2B: PRIORISER (ABC) -->
        <div class="step-container hidden" id="step2b">
            <div class="step-header">
                <div class="step-number">2B</div>
                <div class="step-title">Prioriser mes objectifs (m√©thode ABC)</div>
            </div>

            <div class="step-description">
                <strong>üìä Consigne :</strong> Maintenant que vos objectifs sont bien d√©finis, classez-les selon la m√©thode ABC pour identifier vos priorit√©s.
            </div>

            <div class="priority-legend">
                <div class="priority-legend-item">
                    <div class="priority-badge a">A</div>
                    <div><strong>Priorit√© A :</strong> Grave si pas fait (cons√©quences importantes)</div>
                </div>
                <div class="priority-legend-item">
                    <div class="priority-badge b">B</div>
                    <div><strong>Priorit√© B :</strong> Important mais peut attendre (g√™ne l√©g√®re)</div>
                </div>
                <div class="priority-legend-item">
                    <div class="priority-badge c">C</div>
                    <div><strong>Priorit√© C :</strong> Agr√©able √† faire mais sans cons√©quence</div>
                </div>
            </div>

            <div class="objectives-priority-container" id="objectivesPriorityContainer"></div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goToStep2a()">
                    ‚Üê Retour √† la d√©finition
                </button>
                <button class="btn btn-primary" onclick="goToStep3()" id="btnStep2b">
                    Continuer ‚Üí Plan d'action
                </button>
            </div>
        </div>

        <!-- √âTAPE 3: METTRE EN ≈íUVRE -->
        <div class="step-container hidden" id="step3">
            <div class="step-header">
                <div class="step-number">3</div>
                <div class="step-title">Mon plan d'action</div>
            </div>

            <div class="step-description">
                <strong>üéØ Consigne :</strong> Choisissez une t√¢che priorit√© A align√©e avec vos valeurs, puis d√©finissez une micro-action concr√®te pour cette semaine.
            </div>

            <div id="actionPlanContainer"></div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goToStep2b()">
                    ‚Üê Retour √† la priorisation
                </button>
                <button class="btn btn-primary" onclick="goToStep4()" id="btnStep3">
                    Voir ma synth√®se ‚Üí
                </button>
            </div>
        </div>

        <!-- √âTAPE 4: SYNTH√àSE -->
        <div class="step-container hidden" id="step4">
            <div class="step-header">
                <div class="step-number">4</div>
                <div class="step-title">Ma synth√®se personnelle</div>
            </div>

            <div class="synthesis-preview" id="synthesisContent"></div>

            <div class="btn-container">
                <button class="btn btn-secondary" onclick="goToStep3()">
                    ‚Üê Modifier mon plan
                </button>
                <button class="btn btn-download" onclick="downloadSynthesis()">
                    üì• T√©l√©charger ma fiche synth√®se (PDF)
                </button>
            </div>
        </div>

        <footer class="footer">
            <p>Outil p√©dagogique LS4YOU - Cadre : Identifier, Mesurer, Mettre en ≈ìuvre</p>
            <div class="ml-branding">
                <span>Mission Locale Pays Basque</span>
                <span style="color: var(--turquoise);">‚óè</span>
                <span>Projet Erasmus+ LS4YOU</span>
            </div>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        // Cat√©gories d'objectifs avec exemples
        const categories = [
            { 
                id: 'emploi', 
                icon: 'üíº', 
                nom: 'Emploi & Formation',
                exemples: 'CV, entretien, stage, dipl√¥me...',
                description: 'Objectifs li√©s √† votre parcours professionnel et vos √©tudes'
            },
            { 
                id: 'mobilite', 
                icon: '‚úàÔ∏è', 
                nom: 'Mobilit√©',
                exemples: 'Permis, √©change, voyage...',
                description: 'Objectifs de d√©placement, voyage, mobilit√© internationale'
            },
            { 
                id: 'logement', 
                icon: 'üè†', 
                nom: 'Logement & Autonomie',
                exemples: 'Appart, d√©m√©nagement, vie seul...',
                description: 'Objectifs d\'ind√©pendance, logement, vie quotidienne'
            },
            { 
                id: 'social', 
                icon: 'üë•', 
                nom: 'Vie sociale & Famille',
                exemples: 'Amis, relations, famille...',
                description: 'Objectifs relationnels et de vie sociale'
            },
            { 
                id: 'sante', 
                icon: 'üí™', 
                nom: 'Sant√© & Bien-√™tre',
                exemples: 'Sport, sommeil, alimentation...',
                description: 'Objectifs de sant√© physique et mentale'
            },
            { 
                id: 'financier', 
                icon: 'üí∞', 
                nom: 'Finance & Budget',
                exemples: '√âpargne, dettes, budget...',
                description: 'Objectifs financiers et gestion d\'argent'
            },
            { 
                id: 'perso', 
                icon: 'üéØ', 
                nom: 'D√©veloppement personnel',
                exemples: 'Confiance, comp√©tences, loisirs...',
                description: 'Objectifs de croissance personnelle et passions'
            },
            { 
                id: 'admin', 
                icon: 'üìã', 
                nom: 'D√©marches administratives',
                exemples: 'Papiers, allocations, banque...',
                description: 'Objectifs administratifs et d√©marches officielles'
            },
            { 
                id: 'numerique', 
                icon: 'üíª', 
                nom: 'Num√©rique & Technologie',
                exemples: 'Ordi, r√©seau, comp√©tences digitales...',
                description: 'Objectifs li√©s aux outils num√©riques'
            },
            { 
                id: 'engagement', 
                icon: 'ü§ù', 
                nom: 'Engagement citoyen',
                exemples: 'B√©n√©volat, association, √©cologie...',
                description: 'Objectifs d\'engagement et participation citoyenne'
            }
        ];

        // √âtat de l'application
        let state = {
            selectedValues: [],
            objectives: [
                { 
                    id: 1, 
                    category: null,
                    specific: '',  // S - Quoi pr√©cis√©ment ?
                    measurable: '', // M - Comment savoir que c'est fait ?
                    achievable: '', // A - Avec quelles ressources ?
                    relevant: '',   // R - Pourquoi c'est important ?
                    timebound: '',  // T - Quand / dans combien de temps ?
                    priority: null,
                    action: ''
                },
                { 
                    id: 2, 
                    category: null,
                    specific: '',
                    measurable: '',
                    achievable: '',
                    relevant: '',
                    timebound: '',
                    priority: null,
                    action: ''
                },
                { 
                    id: 3, 
                    category: null,
                    specific: '',
                    measurable: '',
                    achievable: '',
                    relevant: '',
                    timebound: '',
                    priority: null,
                    action: ''
                }
            ],
            currentStep: 1,
            currentObjectiveForCategory: null
        };

        // Initialisation
        function init() {
            renderValuesGrid();
            renderCategoriesGrid();
            renderObjectivesSmartForm();
        }

        // Afficher la grille de cat√©gories
        function renderCategoriesGrid() {
            const grid = document.getElementById('categoriesGrid');
            grid.innerHTML = categories.map(cat => `
                <div class="category-card" data-id="${cat.id}" onclick="selectCategoryInfo('${cat.id}')">
                    <span class="category-icon">${cat.icon}</span>
                    <div class="category-name">${cat.nom}</div>
                    <div class="category-examples">${cat.exemples}</div>
                </div>
            `).join('');
        }

        // S√©lectionner une cat√©gorie (juste pour info/inspiration)
        function selectCategoryInfo(categoryId) {
            // Cette fonction est juste pour afficher visuellement la s√©lection
            // Elle n'affecte pas l'√©tat, c'est juste pour inspiration
            document.querySelectorAll('.category-card').forEach(card => {
                if (card.dataset.id === categoryId) {
                    card.classList.toggle('selected');
                } else {
                    card.classList.remove('selected');
                }
            });
        }

        // Afficher le formulaire SMART pour les objectifs
        function renderObjectivesSmartForm() {
            const container = document.getElementById('objectivesSmartContainer');
            container.innerHTML = state.objectives.map((obj, index) => {
                const category = obj.category ? categories.find(c => c.id === obj.category) : null;
                
                return `
                <div class="smart-objective-card ${category ? 'has-category' : ''}">
                    <div class="objective-card-header">
                        <div class="objective-number-badge">${index + 1}</div>
                        ${category ? `<div class="category-badge">${category.icon} ${category.nom}</div>` : ''}
                    </div>

                    <button class="category-select-btn ${obj.category ? 'selected' : ''}" 
                            onclick="openCategorySelector(${obj.id})">
                        ${obj.category ? `${categories.find(c => c.id === obj.category).icon} ${categories.find(c => c.id === obj.category).nom}` : 'üìÇ Choisir une cat√©gorie (optionnel)'}
                    </button>

                    <div class="smart-section">
                        <div class="smart-label">
                            <span class="smart-letter">S</span>
                            Sp√©cifique - Quel est mon objectif pr√©cis ?
                        </div>
                        <div class="smart-help">Ex: "Obtenir mon permis B" plut√¥t que "avoir le permis"</div>
                        <input type="text" 
                               id="obj-specific-${obj.id}"
                               placeholder="Mon objectif pr√©cis..."
                               value="${obj.specific}"
                               onchange="updateObjectiveSmart(${obj.id}, 'specific', this.value)">
                    </div>

                    <div class="smart-section">
                        <div class="smart-label">
                            <span class="smart-letter">M</span>
                            Mesurable - Comment savoir que c'est r√©ussi ?
                        </div>
                        <div class="smart-help">Ex: "J'ai le permis en main" ou "J'ai pass√© l'examen"</div>
                        <input type="text" 
                               id="obj-measurable-${obj.id}"
                               placeholder="Je saurai que c'est fait quand..."
                               value="${obj.measurable}"
                               onchange="updateObjectiveSmart(${obj.id}, 'measurable', this.value)">
                    </div>

                    <div class="smart-section">
                        <div class="smart-label">
                            <span class="smart-letter">A</span>
                            Atteignable - Quelles ressources j'ai / je dois avoir ?
                        </div>
                        <div class="smart-help">Ex: "Auto-√©cole pay√©e, 20h de conduite pr√©vues"</div>
                        <input type="text" 
                               id="obj-achievable-${obj.id}"
                               placeholder="Ce dont j'ai besoin / ce que j'ai d√©j√†..."
                               value="${obj.achievable}"
                               onchange="updateObjectiveSmart(${obj.id}, 'achievable', this.value)">
                    </div>

                    <div class="smart-section">
                        <div class="smart-label">
                            <span class="smart-letter">R</span>
                            R√©aliste - Pourquoi c'est important pour moi ?
                        </div>
                        <div class="smart-help">Ex: "Pour trouver un emploi et √™tre autonome"</div>
                        <textarea id="obj-relevant-${obj.id}"
                                  placeholder="Ce que √ßa va m'apporter..."
                                  onchange="updateObjectiveSmart(${obj.id}, 'relevant', this.value)">${obj.relevant}</textarea>
                    </div>

                    <div class="smart-section">
                        <div class="smart-label">
                            <span class="smart-letter">T</span>
                            Temporel - Quand ? Dans combien de temps ?
                        </div>
                        <div class="smart-help">Ex: "D'ici 3 mois" ou "Avant fin juin 2026"</div>
                        <input type="text" 
                               id="obj-timebound-${obj.id}"
                               placeholder="Ma deadline..."
                               value="${obj.timebound}"
                               onchange="updateObjectiveSmart(${obj.id}, 'timebound', this.value)">
                    </div>
                </div>
            `}).join('');

            validateStep2a();
        }

        // Ouvrir le s√©lecteur de cat√©gorie
        // S√©lection de cat√©gorie avec modal
        let selectedCategoryTemp = null;
        let currentObjectiveIdForCategory = null;

        function openCategorySelector(objectiveId) {
            const obj = state.objectives.find(o => o.id === objectiveId);
            currentObjectiveIdForCategory = objectiveId;
            selectedCategoryTemp = obj.category;

            // Remplir le modal
            const grid = document.getElementById('categoryModalGrid');
            grid.innerHTML = categories.map(cat => `
                <div class="category-modal-card ${obj.category === cat.id ? 'selected' : ''}" 
                     data-category="${cat.id}"
                     onclick="selectCategoryInModal('${cat.id}')">
                    <span class="category-modal-icon">${cat.icon}</span>
                    <div class="category-modal-name">${cat.nom}</div>
                </div>
            `).join('');

            // Afficher le modal
            document.getElementById('categoryModal').classList.add('active');
        }

        function selectCategoryInModal(categoryId) {
            selectedCategoryTemp = categoryId;
            
            // Mettre √† jour la s√©lection visuelle
            document.querySelectorAll('.category-modal-card').forEach(card => {
                if (card.dataset.category === categoryId) {
                    card.classList.add('selected');
                } else {
                    card.classList.remove('selected');
                }
            });
        }

        function confirmCategorySelection() {
            if (currentObjectiveIdForCategory !== null) {
                const obj = state.objectives.find(o => o.id === currentObjectiveIdForCategory);
                if (obj) {
                    obj.category = selectedCategoryTemp;
                    renderObjectivesSmartForm();
                }
            }
            closeCategoryModal();
        }

        function closeCategoryModal() {
            document.getElementById('categoryModal').classList.remove('active');
            selectedCategoryTemp = null;
            currentObjectiveIdForCategory = null;
        }

        // Mettre √† jour un champ SMART
        function updateObjectiveSmart(id, field, value) {
            const obj = state.objectives.find(o => o.id === id);
            if (obj) {
                obj[field] = value;
                validateStep2a();
            }
        }

        // Valider l'√©tape 2a
        function validateStep2a() {
            const allComplete = state.objectives.every(obj => 
                obj.specific.trim() !== '' &&
                obj.measurable.trim() !== '' &&
                obj.timebound.trim() !== ''
            );
            
            const btnStep2a = document.getElementById('btnStep2a');
            if (btnStep2a) {
                btnStep2a.disabled = !allComplete;
            }
        }

        // Afficher les objectifs pour priorisation
        function renderObjectivesPriority() {
            const container = document.getElementById('objectivesPriorityContainer');
            container.innerHTML = state.objectives.map((obj, index) => {
                const category = obj.category ? categories.find(c => c.id === obj.category) : null;
                
                return `
                <div class="priority-objective-card">
                    <div class="priority-objective-summary">
                        <div class="priority-objective-title">
                            ${category ? `${category.icon}` : 'üéØ'} ${obj.specific}
                        </div>
                        <div class="priority-objective-details">
                            <strong>Pourquoi :</strong> ${obj.relevant || 'Non pr√©cis√©'}<br>
                            <strong>Deadline :</strong> ${obj.timebound}
                        </div>
                        <div class="smart-recap">
                            <div class="smart-recap-item">
                                <span class="smart-recap-label">üìè Mesure</span>
                                ${obj.measurable}
                            </div>
                            ${obj.achievable ? `
                            <div class="smart-recap-item">
                                <span class="smart-recap-label">üîß Ressources</span>
                                ${obj.achievable}
                            </div>
                            ` : ''}
                        </div>
                    </div>

                    <div class="priority-selector">
                        <button class="priority-btn priority-a ${obj.priority === 'A' ? 'selected' : ''}"
                                onclick="updateObjectivePriority(${obj.id}, 'A')">
                            <strong>A</strong> - Grave si pas fait
                        </button>
                        <button class="priority-btn priority-b ${obj.priority === 'B' ? 'selected' : ''}"
                                onclick="updateObjectivePriority(${obj.id}, 'B')">
                            <strong>B</strong> - Important
                        </button>
                        <button class="priority-btn priority-c ${obj.priority === 'C' ? 'selected' : ''}"
                                onclick="updateObjectivePriority(${obj.id}, 'C')">
                            <strong>C</strong> - Agr√©able
                        </button>
                    </div>
                </div>
            `}).join('');
        }

        // Mettre √† jour la priorit√©
        function updateObjectivePriority(id, priority) {
            const obj = state.objectives.find(o => o.id === id);
            if (obj) {
                obj.priority = priority;
                renderObjectivesPriority();
                validateStep2b();
            }
        }

        // Valider l'√©tape 2b
        function validateStep2b() {
            const hasAllPriorities = state.objectives.every(obj => obj.priority !== null);
            const btnStep2b = document.getElementById('btnStep2b');
            if (btnStep2b) {
                btnStep2b.disabled = !hasAllPriorities;
            }
        }

        // Donn√©es des valeurs (issues de FJET)
        const valeurs = [
            { id: 1, icon: "üé≠", nom: "√ätre authentique", description: "Se montrer ¬´ vrai ¬ª, √™tre soi-m√™me" },
            { id: 2, icon: "üìú", nom: "Respecter les r√®gles", description: "Suivre les normes et cadres √©tablis" },
            { id: 3, icon: "üåà", nom: "√ätre ouvert d'esprit", description: "Ne pas juger, accepter la diff√©rence" },
            { id: 4, icon: "ü§ù", nom: "√ätre loyal", description: "Digne de confiance, fid√®le" },
            { id: 5, icon: "üåç", nom: "Contribuer √† la soci√©t√©", description: "Participer au bien commun" },
            { id: 6, icon: "üîç", nom: "√ätre curieux", description: "Ouvert √† la d√©couverte, √† l'apprentissage" },
            { id: 7, icon: "üë•", nom: "Coop√©rer", description: "Collaborer, travailler ensemble" },
            { id: 8, icon: "ü¶Å", nom: "√ätre courageux", description: "Oser affronter les d√©fis" },
            { id: 9, icon: "üíé", nom: "√ätre honn√™te", description: "Dire la v√©rit√©, √™tre transparent" },
            { id: 10, icon: "‚ú®", nom: "Appr√©cier la beaut√©", description: "Valoriser l'esth√©tique, l'harmonie" },
            { id: 11, icon: "üéâ", nom: "Avoir du plaisir", description: "Profiter, s'amuser" },
            { id: 12, icon: "üéØ", nom: "S'appliquer", description: "Faire les choses avec soin" },
            { id: 13, icon: "üìã", nom: "√ätre ordonn√©", description: "Bien organiser, structurer" },
            { id: 14, icon: "ü§≤", nom: "Entraider", description: "Soutenir, aider les autres" },
            { id: 15, icon: "üì¢", nom: "Influencer", description: "Inspirer, convaincre les autres" },
            { id: 16, icon: "üíï", nom: "Se sentir proche", description: "Connect√©, li√© aux autres" },
            { id: 17, icon: "‚öñÔ∏è", nom: "Chercher l'√©quit√©", description: "Viser la justice, l'√©galit√©" },
            { id: 18, icon: "üïäÔ∏è", nom: "√ätre libre", description: "Ind√©pendant, autonome" },
            { id: 19, icon: "üôè", nom: "Savoir pardonner", description: "√Ä soi-m√™me et aux autres" },
            { id: 20, icon: "üé®", nom: "Cultiver la cr√©ativit√©", description: "Imaginer, innover" },
            { id: 21, icon: "üåü", nom: "Se respecter", description: "Respecter soi et les autres" },
            { id: 22, icon: "üéÅ", nom: "√ätre g√©n√©reux", description: "Donner, partager" },
            { id: 23, icon: "üí™", nom: "Pers√©v√©rer", description: "Continuer malgr√© les difficult√©s" },
            { id: 24, icon: "üèîÔ∏è", nom: "Go√ªt du risque", description: "Aventure, d√©fi, audace" }
        ];

        // Initialisation
        function init() {
            renderValuesGrid();
            renderCategoriesGrid();
            renderObjectivesSmartForm();
        }

        // Afficher la grille de valeurs
        function renderValuesGrid() {
            const grid = document.getElementById('valuesGrid');
            grid.innerHTML = valeurs.map(v => `
                <div class="value-card" data-id="${v.id}" onclick="toggleValue(${v.id})">
                    <div class="checkbox-custom"></div>
                    <div class="value-content">
                        <div class="value-icon">${v.icon}</div>
                        <div class="value-name">${v.nom}</div>
                        <div class="value-description">${v.description}</div>
                    </div>
                </div>
            `).join('');
        }

        // S√©lectionner/d√©s√©lectionner une valeur
        function toggleValue(id) {
            const index = state.selectedValues.indexOf(id);
            
            if (index === -1) {
                if (state.selectedValues.length < 7) {
                    state.selectedValues.push(id);
                } else {
                    showValidation("Vous avez d√©j√† s√©lectionn√© 7 valeurs. D√©s√©lectionnez-en une pour en ajouter une autre.");
                    return;
                }
            } else {
                state.selectedValues.splice(index, 1);
            }

            updateValuesDisplay();
        }

        // Mettre √† jour l'affichage des valeurs
        function updateValuesDisplay() {
            // Mise √† jour des cartes
            document.querySelectorAll('.value-card').forEach(card => {
                const id = parseInt(card.dataset.id);
                if (state.selectedValues.includes(id)) {
                    card.classList.add('selected');
                } else {
                    card.classList.remove('selected');
                }
            });

            // Mise √† jour du r√©sum√©
            const count = state.selectedValues.length;
            const summary = document.getElementById('selectionSummary');
            const countEl = document.getElementById('selectedCount');
            const listEl = document.getElementById('selectedValuesList');
            const btnStep1 = document.getElementById('btnStep1');

            countEl.textContent = count;

            if (count > 0) {
                summary.style.display = 'block';
                listEl.innerHTML = state.selectedValues
                    .map(id => {
                        const v = valeurs.find(val => val.id === id);
                        return `<div class="selected-value-tag">${v.icon} ${v.nom}</div>`;
                    })
                    .join('');
                
                if (count >= 5) {
                    btnStep1.disabled = false;
                    hideValidation();
                } else {
                    btnStep1.disabled = true;
                    showValidation(`S√©lectionnez au moins 5 valeurs (${count}/5)`);
                }
            } else {
                summary.style.display = 'none';
                btnStep1.disabled = true;
            }
        }

        // Afficher/masquer message de validation
        function showValidation(message) {
            const msg = document.getElementById('validationMsg');
            msg.textContent = message;
            msg.style.display = 'block';
        }

        function hideValidation() {
            document.getElementById('validationMsg').style.display = 'none';
        }


        // Navigation entre √©tapes
        function goToStep1() {
            showStep(1);
        }

        function goToStep2a() {
            if (state.selectedValues.length < 5) {
                showValidation("S√©lectionnez au moins 5 valeurs avant de continuer.");
                return;
            }
            renderObjectivesSmartForm();
            showStep('2a');
        }

        function goToStep2b() {
            const allComplete = state.objectives.every(obj => 
                obj.specific.trim() !== '' &&
                obj.measurable.trim() !== '' &&
                obj.timebound.trim() !== ''
            );
            
            if (!allComplete) {
                alert("Compl√©tez au minimum les champs S (sp√©cifique), M (mesurable) et T (temporel) pour chaque objectif.");
                return;
            }
            
            renderObjectivesPriority();
            showStep('2b');
        }

        function goToStep3() {
            const hasAllPriorities = state.objectives.every(obj => obj.priority !== null);
            
            if (!hasAllPriorities) {
                alert("Classez tous vos objectifs selon la m√©thode ABC avant de continuer.");
                return;
            }
            
            renderActionPlan();
            showStep(3);
        }

        function goToStep4() {
            const hasAction = state.objectives.some(obj => obj.priority === 'A' && obj.action.trim() !== '');
            if (!hasAction) {
                alert("D√©finissez au moins une micro-action pour une t√¢che priorit√© A.");
                return;
            }
            
            renderSynthesis();
            showStep(4);
        }

        function showStep(stepNumber) {
            const steps = [1, '2a', '2b', 3, 4];
            steps.forEach(s => {
                const step = document.getElementById(`step${s}`);
                if (step) {
                    if (s === stepNumber) {
                        step.classList.remove('hidden');
                        step.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    } else {
                        step.classList.add('hidden');
                    }
                }
            });
            state.currentStep = stepNumber;
        }

        // Afficher le plan d'action
        function renderActionPlan() {
            const container = document.getElementById('actionPlanContainer');
            const priorityA = state.objectives.filter(obj => obj.priority === 'A');

            if (priorityA.length === 0) {
                container.innerHTML = `
                    <div class="info-callout">
                        <h3>‚ÑπÔ∏è Aucune t√¢che priorit√© A</h3>
                        <p>Vous n'avez pas de t√¢che class√©e en priorit√© A. Retournez √† l'√©tape pr√©c√©dente pour ajuster vos priorit√©s.</p>
                    </div>
                `;
                document.getElementById('btnStep3').disabled = true;
                return;
            }

            container.innerHTML = `
                <div class="info-callout">
                    <h3>üéØ Choisissez votre objectif prioritaire</h3>
                    <p>S√©lectionnez une t√¢che priorit√© A qui correspond √† vos valeurs, puis d√©finissez une action concr√®te pour cette semaine.</p>
                </div>

                ${priorityA.map(obj => {
                    const category = obj.category ? categories.find(c => c.id === obj.category) : null;
                    return `
                    <div class="objective-item">
                        <div class="objective-header">
                            <div class="priority-badge a">A</div>
                            <div style="flex: 1;">
                                <strong>${category ? `${category.icon} ` : ''}${obj.specific}</strong>
                                <p style="color: #666; font-size: 0.9rem; margin-top: 0.3rem;">
                                    <strong>Pourquoi :</strong> ${obj.relevant}<br>
                                    <strong>Deadline :</strong> ${obj.timebound}
                                </p>
                            </div>
                        </div>
                        
                        <div class="action-input">
                            <div class="objective-label">üöÄ Ma micro-action cette semaine</div>
                            <input type="text" 
                                   id="action-${obj.id}"
                                   placeholder="Ex: Faire une version de mon CV mardi, checker avec mon conseiller ML"
                                   value="${obj.action}"
                                   onchange="updateObjective(${obj.id}, 'action', this.value); validateStep3();">
                        </div>
                    </div>
                `}).join('')}
            `;

            validateStep3();
        }

        // Mise √† jour objectif (compatibilit√©)
        function updateObjective(id, field, value) {
            const obj = state.objectives.find(o => o.id === id);
            if (obj) {
                obj[field] = value;
            }
        }

        // Valider l'√©tape 3
        function validateStep3() {
            const hasAction = state.objectives.some(obj => obj.priority === 'A' && obj.action.trim() !== '');
            const btn = document.getElementById('btnStep3');
            if (btn) btn.disabled = !hasAction;
        }

        // G√©n√©rer la synth√®se
        function renderSynthesis() {
            const container = document.getElementById('synthesisContent');
            const selectedValeurs = state.selectedValues.map(id => valeurs.find(v => v.id === id));
            const priorityAWithAction = state.objectives.filter(obj => obj.priority === 'A' && obj.action.trim() !== '');

            container.innerHTML = `
                <div class="synthesis-section">
                    <h3>üåü Mes valeurs prioritaires</h3>
                    ${selectedValeurs.map(v => `
                        <div class="value-explanation">
                            <h4>${v.icon} ${v.nom}</h4>
                            <p><strong>Ce que √ßa signifie :</strong> ${v.description}</p>
                        </div>
                    `).join('')}
                </div>

                <div class="synthesis-section">
                    <h3>üìä Mes objectifs SMART class√©s (ABC)</h3>
                    ${state.objectives.sort((a, b) => {
                        const order = { 'A': 1, 'B': 2, 'C': 3 };
                        return order[a.priority] - order[b.priority];
                    }).map(obj => {
                        const category = obj.category ? categories.find(c => c.id === obj.category) : null;
                        return `
                        <div class="objective-card">
                            <div class="objective-card-header">
                                <div class="objective-priority-badge" style="background: ${
                                    obj.priority === 'A' ? 'var(--rouge)' : 
                                    obj.priority === 'B' ? 'var(--orange)' : 
                                    'var(--jaune)'
                                }; ${obj.priority === 'C' ? 'color: var(--gris-fonce)' : ''}">
                                    ${obj.priority}
                                </div>
                                <div class="objective-title">
                                    ${category ? `${category.icon} ` : ''}${obj.specific}
                                </div>
                            </div>
                            <div class="objective-details">
                                <strong>üìè Mesure de r√©ussite :</strong> ${obj.measurable}<br>
                                ${obj.achievable ? `<strong>üîß Ressources :</strong> ${obj.achievable}<br>` : ''}
                                <strong>üí° Pourquoi c'est important :</strong> ${obj.relevant}<br>
                                <strong>‚è∞ Deadline :</strong> ${obj.timebound}
                            </div>
                            ${obj.action ? `
                                <div class="action-highlight">
                                    <strong>üí™ Mon action cette semaine :</strong> ${obj.action}
                                </div>
                            ` : ''}
                        </div>
                    `}).join('')}
                </div>

                <div class="synthesis-section">
                    <h3>üéØ Mon engagement cette semaine</h3>
                    ${priorityAWithAction.map(obj => {
                        const category = obj.category ? categories.find(c => c.id === obj.category) : null;
                        return `
                        <div class="info-callout">
                            <h3>${category ? `${category.icon} ` : ''}${obj.specific}</h3>
                            <p><strong>üöÄ Action concr√®te :</strong> ${obj.action}</p>
                            <p style="font-size: 0.9rem; opacity: 0.9; margin-top: 0.5rem;">
                                <strong>Date limite :</strong> ${obj.timebound}
                            </p>
                        </div>
                    `}).join('')}
                </div>
            `;
        }

        // T√©l√©charger la synth√®se en PDF
        function downloadSynthesis() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Configuration
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            const margin = 20;
            const lineHeight = 7;
            let yPos = margin;

            // Couleurs LS4YOU
            const turquoise = [93, 217, 193];
            const rouge = [232, 72, 85];
            const jaune = [255, 210, 63];

            // En-t√™te avec logo symbolique
            doc.setFillColor(...turquoise);
            doc.rect(0, 0, pageWidth, 30, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(20);
            doc.setFont(undefined, 'bold');
            doc.text('MA SYNTH√àSE PERSONNELLE', pageWidth / 2, 15, { align: 'center' });
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Valeurs en Priorit√© ABC - LS4YOU', pageWidth / 2, 22, { align: 'center' });

            yPos = 40;

            // Section 1: Mes valeurs
            doc.setTextColor(93, 217, 193);
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('MES VALEURS PRIORITAIRES', margin, yPos);
            yPos += 10;

            const selectedValeurs = state.selectedValues.map(id => valeurs.find(v => v.id === id));
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            
            selectedValeurs.forEach((v, index) => {
                if (yPos > pageHeight - 40) {
                    doc.addPage();
                    yPos = margin;
                }

                doc.setFont(undefined, 'bold');
                doc.text(`${index + 1}. ${v.nom}`, margin + 5, yPos);
                yPos += lineHeight;

                doc.setFont(undefined, 'normal');
                doc.setFontSize(9);
                const description = doc.splitTextToSize(`   ${v.description}`, pageWidth - 2 * margin - 10);
                doc.text(description, margin + 5, yPos);
                yPos += description.length * 5 + 3;
                doc.setFontSize(10);
            });

            yPos += 5;

            // Section 2: Mes objectifs SMART + ABC
            if (yPos > pageHeight - 60) {
                doc.addPage();
                yPos = margin;
            }

            doc.setTextColor(232, 72, 85);
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('MES OBJECTIFS SMART CLASS√âS (ABC)', margin, yPos);
            yPos += 10;

            const sortedObjectives = [...state.objectives].sort((a, b) => {
                const order = { 'A': 1, 'B': 2, 'C': 3 };
                return order[a.priority] - order[b.priority];
            });

            sortedObjectives.forEach(obj => {
                if (yPos > pageHeight - 80) {
                    doc.addPage();
                    yPos = margin;
                }

                // Badge priorit√©
                const priorityColors = {
                    'A': rouge,
                    'B': [255, 184, 77],
                    'C': jaune
                };
                
                doc.setFillColor(...priorityColors[obj.priority]);
                doc.roundedRect(margin + 2, yPos - 4, 10, 8, 2, 2, 'F');
                
                doc.setTextColor(255, 255, 255);
                if (obj.priority === 'C') doc.setTextColor(0, 0, 0);
                doc.setFontSize(10);
                doc.setFont(undefined, 'bold');
                doc.text(obj.priority, margin + 7, yPos + 1, { align: 'center' });

                // Cat√©gorie si pr√©sente
                const category = obj.category ? categories.find(c => c.id === obj.category) : null;

                // Texte objectif (SMART - Sp√©cifique)
                doc.setTextColor(0, 0, 0);
                doc.setFont(undefined, 'bold');
                doc.text(`${category ? category.nom + ' - ' : ''}${obj.specific}`, margin + 15, yPos);
                yPos += lineHeight;

                // D√©tails SMART
                doc.setFont(undefined, 'normal');
                doc.setFontSize(8);

                // Mesurable
                if (obj.measurable) {
                    doc.setFont(undefined, 'bold');
                    doc.text('Mesure:', margin + 15, yPos);
                    doc.setFont(undefined, 'normal');
                    const measText = doc.splitTextToSize(obj.measurable, pageWidth - 2 * margin - 35);
                    doc.text(measText, margin + 33, yPos);
                    yPos += measText.length * 4 + 2;
                }

                // Atteignable (ressources)
                if (obj.achievable) {
                    doc.setFont(undefined, 'bold');
                    doc.text('Ressources:', margin + 15, yPos);
                    doc.setFont(undefined, 'normal');
                    const achText = doc.splitTextToSize(obj.achievable, pageWidth - 2 * margin - 35);
                    doc.text(achText, margin + 40, yPos);
                    yPos += achText.length * 4 + 2;
                }

                // R√©aliste (pourquoi)
                if (obj.relevant) {
                    doc.setFont(undefined, 'bold');
                    doc.text('Pourquoi:', margin + 15, yPos);
                    doc.setFont(undefined, 'normal');
                    const relText = doc.splitTextToSize(obj.relevant, pageWidth - 2 * margin - 35);
                    doc.text(relText, margin + 35, yPos);
                    yPos += relText.length * 4 + 2;
                }

                // Temporel
                if (obj.timebound) {
                    doc.setFont(undefined, 'bold');
                    doc.text('Deadline:', margin + 15, yPos);
                    doc.setFont(undefined, 'normal');
                    doc.text(obj.timebound, margin + 35, yPos);
                    yPos += 5;
                }

                doc.setFontSize(10);

                // Action si pr√©sente
                if (obj.action) {
                    doc.setFillColor(248, 249, 250);
                    doc.rect(margin + 15, yPos - 2, pageWidth - 2 * margin - 15, 12, 'F');
                    
                    doc.setFont(undefined, 'bold');
                    doc.setFontSize(9);
                    doc.setTextColor(232, 72, 85);
                    doc.text('Action cette semaine:', margin + 18, yPos + 3);
                    
                    doc.setFont(undefined, 'normal');
                    doc.setTextColor(0, 0, 0);
                    const actionText = doc.splitTextToSize(obj.action, pageWidth - 2 * margin - 60);
                    doc.text(actionText, margin + 55, yPos + 3);
                    yPos += 15;
                }

                yPos += 4;
                doc.setFontSize(10);
            });

            // Footer
            doc.setFontSize(8);
            doc.setTextColor(100, 100, 100);
            doc.text('Mission Locale Pays Basque - Projet Erasmus+ LS4YOU', pageWidth / 2, pageHeight - 10, { align: 'center' });
            doc.text(`G√©n√©r√© le ${new Date().toLocaleDateString('fr-FR')}`, pageWidth / 2, pageHeight - 5, { align: 'center' });

            // T√©l√©chargement
            doc.save('Ma-Synthese-Valeurs-ABC-SMART.pdf');
        }

        // Initialisation au chargement
        window.onload = init;
    </script>
</body>
</html>
